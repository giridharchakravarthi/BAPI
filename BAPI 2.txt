PARAMETER PFILE TYPE IBIPPARMS-PATH.
TYPES : BEGIN OF TY,
        BANK_CTRY TYPE BAPI1011_KEY-BANK_CTRY,
        BANKKEY TYPE BAPI1011_KEY-BANK_KEY,
        STREET TYPE STRAS_GP,
        CITY TYPE ORT01_GP,
        END OF TY.
DATA :  WA TYPE TY,
        IT TYPE TABLE OF TY,
        FFILE TYPE STRING,
        WA_ADD TYPE BAPI1011_ADDRESS,
        WA_RET TYPE BAPIRET2,
        IT_RET TYPE TABLE OF BAPIRET2,
        WA_ADDX TYPE BAPI1011_ADDRESSX.
AT SELECTION-SCREEN ON VALUE-REQUEST FOR PFILE.
CALL FUNCTION 'F4_FILENAME'
 IMPORTING
   FILE_NAME       = PFILE.
START-OF-SELECTION.
FFILE = PFILE.
CALL FUNCTION 'GUI_UPLOAD'
  EXPORTING
    FILENAME                      = FFILE
    HAS_FIELD_SEPARATOR           = 'X'
  TABLES
    DATA_TAB                      = IT.
LOOP AT IT INTO WA.
WA_ADD-STREET = WA-STREET.
WA_ADD-CITY = WA-CITY.
WA_ADDX-STREET = 'X'.
WA_ADDX-CITY = 'X'.
CALL FUNCTION 'BAPI_BANK_CHANGE'
  EXPORTING
    BANKCOUNTRY               = WA-BANK_CTRY
    BANKKEY                   = WA-BANKKEY
    BANK_ADDRESS              = WA_ADD
    BANK_ADDRESSX             = WA_ADDX
 IMPORTING
   RETURN                    = WA_RET.
CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'.
IF WA_RET IS NOT INITIAL.
APPEND WA_RET TO IT_RET.
ENDIF.
ENDLOOP.
IF IT_RET IS INITIAL.
WRITE 'SUCESSFULLY UPDATED'.
ELSE.
CL_DEMO_OUTPUT=>DISPLAY( IT_RET ).
ENDIF.